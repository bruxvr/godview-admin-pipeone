<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard de Contas - Teste Simples</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="header-left">
          <button class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-bars"></i>
          </button>
          <h1 class="app-title">Dashboard de Contas</h1>
        </div>
        <div class="header-right">
          <button class="header-btn" id="themeToggle">
            <i class="fas fa-moon"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <input
          type="text"
          class="form-control"
          id="searchAccounts"
          placeholder="Buscar contas..."
        />
      </div>
      <div class="sidebar-content">
        <div class="accounts-tree" id="accountsTree">
          <!-- Árvore de contas será inserida aqui -->
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Dashboard Page -->
      <div class="page" id="dashboardPage">
        <div class="page-header">
          <h2>Dashboard</h2>
        </div>

        <!-- Metrics Cards -->
        <div class="metrics-grid">
          <div class="card metric-card">
            <div class="card__body">
              <div class="metric-header">
                <h3>Total de Contas</h3>
                <i class="fas fa-users metric-icon"></i>
              </div>
              <div class="metric-value">
                <span class="metric-number" id="metricContas"
                  >Carregando...</span
                >
                <span class="metric-change positive" id="metricContasChange"
                  >+0%</span
                >
              </div>
            </div>
          </div>

          <div class="card metric-card">
            <div class="card__body">
              <div class="metric-header">
                <h3>Erros do Mês</h3>
                <i class="fas fa-exclamation-triangle metric-icon"></i>
              </div>
              <div class="metric-value">
                <span class="metric-number" id="metricErros"
                  >Carregando...</span
                >
                <span class="metric-change negative" id="metricErrosChange"
                  >-0%</span
                >
              </div>
            </div>
          </div>

          <div class="card metric-card">
            <div class="card__body">
              <div class="metric-header">
                <h3>MTMO Total</h3>
                <i class="fas fa-chart-line metric-icon"></i>
              </div>
              <div class="metric-value">
                <span class="metric-number" id="metricMtmo">Carregando...</span>
                <span class="metric-change positive" id="metricMtmoChange"
                  >+0%</span
                >
              </div>
            </div>
          </div>

          <div class="card metric-card">
            <div class="card__body">
              <div class="metric-header">
                <h3>Canais Ativos</h3>
                <i class="fas fa-plug metric-icon"></i>
              </div>
              <div class="metric-value">
                <span class="metric-number" id="metricCanais"
                  >Carregando...</span
                >
                <span class="metric-change neutral" id="metricCanaisChange"
                  >0%</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Ranking Table -->
        <div class="card">
          <div class="card__body">
            <div class="table-header">
              <h3>Ranking de Contas</h3>
            </div>
            <div class="table-container">
              <table class="data-table" id="rankingTable">
                <thead>
                  <tr>
                    <th>Conta</th>
                    <th>Tipo</th>
                    <th>Status</th>
                    <th>Contatos</th>
                    <th>MTMO</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="rankingTableBody">
                  <tr>
                    <td colspan="6">Carregando dados...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      console.log("=== TESTE SIMPLIFICADO INICIADO ===");

      // Dados básicos
      const dados = {
        metricas: {
          totalContas: { valor: 5, variacao: "+25%" },
          errosDoMes: { valor: 42, variacao: "-12%" },
          mtmoTotal: { valor: "8.7K", variacao: "+8%" },
          canaisAtivos: { valor: 18, variacao: "+5%" },
        },
        contas: [
          {
            id: 1,
            nome: "Cantina do Marcio",
            tipo: "Enterprise",
            status: "Active",
            contatos: 15420,
            mtmo: 3450,
          },
          {
            id: 2,
            nome: "Unidade Ingá",
            tipo: "Department",
            status: "Active",
            contatos: 2890,
            mtmo: 670,
          },
          {
            id: 3,
            nome: "Boteco do Gabriel",
            tipo: "Enterprise",
            status: "Active",
            contatos: 9870,
            mtmo: 2340,
          },
          {
            id: 4,
            nome: "Lojinha da Bruna",
            tipo: "Startup",
            status: "Trial",
            contatos: 2340,
            mtmo: 560,
          },
          {
            id: 5,
            nome: "Tech Solutions",
            tipo: "Enterprise",
            status: "Active",
            contatos: 12500,
            mtmo: 2890,
          },
        ],
      };

      function forcarRenderizacao() {
        console.log("Forçando renderização dos dados...");

        // Métricas
        document.getElementById("metricContas").textContent =
          dados.metricas.totalContas.valor;
        document.getElementById("metricContasChange").textContent =
          dados.metricas.totalContas.variacao;

        document.getElementById("metricErros").textContent =
          dados.metricas.errosDoMes.valor;
        document.getElementById("metricErrosChange").textContent =
          dados.metricas.errosDoMes.variacao;

        document.getElementById("metricMtmo").textContent =
          dados.metricas.mtmoTotal.valor;
        document.getElementById("metricMtmoChange").textContent =
          dados.metricas.mtmoTotal.variacao;

        document.getElementById("metricCanais").textContent =
          dados.metricas.canaisAtivos.valor;
        document.getElementById("metricCanaisChange").textContent =
          dados.metricas.canaisAtivos.variacao;

        // Árvore de contas
        const accountsTree = document.getElementById("accountsTree");
        let html = "<ul>";
        dados.contas.forEach((conta) => {
          html += `<li style="padding: 8px; border-bottom: 1px solid #eee;">
                    <strong>${conta.nome}</strong><br>
                    <small>${conta.tipo} - ${conta.status}</small>
                </li>`;
        });
        html += "</ul>";
        accountsTree.innerHTML = html;

        // Tabela de ranking
        const tbody = document.getElementById("rankingTableBody");
        let tableHtml = "";
        dados.contas.forEach((conta) => {
          tableHtml += `
                    <tr>
                        <td><strong>${conta.nome}</strong></td>
                        <td><span class="type-badge">${conta.tipo}</span></td>
                        <td><span class="status status--${
                          conta.status === "Active" ? "success" : "warning"
                        }">${conta.status}</span></td>
                        <td>${conta.contatos.toLocaleString("pt-BR")}</td>
                        <td>${conta.mtmo.toLocaleString("pt-BR")}</td>
                        <td><button class="btn btn--sm btn--primary">Ver</button></td>
                    </tr>
                `;
        });
        tbody.innerHTML = tableHtml;

        console.log("✅ Dados renderizados com sucesso!");
      }

      // Aguardar DOM carregar
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", function () {
          console.log("DOM carregado");
          setTimeout(forcarRenderizacao, 100);
        });
      } else {
        console.log("DOM já estava carregado");
        setTimeout(forcarRenderizacao, 100);
      }

      // Também executar após carregamento completo
      window.addEventListener("load", function () {
        console.log("Página completamente carregada");
        setTimeout(forcarRenderizacao, 200);
      });

      // Botões básicos
      document.addEventListener("click", function (e) {
        if (e.target.id === "sidebarToggle") {
          document.getElementById("sidebar").classList.toggle("active");
        }
        if (e.target.id === "themeToggle") {
          document.body.classList.toggle("dark-theme");
        }
      });
    </script>
  </body>
</html>
